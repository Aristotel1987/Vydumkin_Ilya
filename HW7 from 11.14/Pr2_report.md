
# Отчет по подбору модели классификации вин

Достаточно часто именные вина подделываются похожими по вкусу физическим характеристикам аналогами. В то же время элитные виноградники ограничены по своей площади, и на рынке вин особенно важно точно установить происхождение конкретного вина. Наша модель нацелена на наиболее точное предсказание происхождения вина по объективным химическим показателям. В представленных для построения модели данных содержится информация о 178 винах из 3-х регионов. Географическое распределение представлено в таблице ниже:

| Регион | Количество вин |
|--------|----------------|
| 0      | 59             |
| 1      | 71             |
| 2      | 48             |

Для анализа использовались 13 факторов, описывающие химические и физические характеристики напитка:
1. **alcohol** - алкоголь (содержание алкоголя в вине)
2. **malic_acid** - яблочная кислота (содержание яблочной кислоты)
3. **ash** - зола (содержание золы в вине)
4. **alcalinity_of_ash** - щелочность золы (показатель щелочности, который может влиять на вкус вина)
5. **magnesium** - магний (содержание магния)
6. **total_phenols** - общие фенолы (общее количество фенольных соединений, влияющих на вкус и цвет вина)
7. **flavanoids** - флавоноиды (класс веществ, обладающих антиоксидантными свойствами, которые также влияют на вкус и цвет)
8. **nonflavanoid_phenols** - нефлавоноидные фенолы (панель других фенольных соединений, не относящихся к флавоноидам)
9. **proanthocyanins** - проантоцианины (тип полифенолов, влияющих на цвет и вкус)
10. **color_intensity** - интенсивность цвета (показатель цвета вина)
11. **hue** - оттенок (цветовой оттенок вина)
12. **od280/od315_of_diluted_wines** - оптическая плотность 280/315 разбавленных вин (показатель, используемый для оценки качества вина)
13. **proline** - пролин (аминокислота, содержание которой может дать представление о стиле и качестве вина)

В качестве возможных предсказательных моделей рассматривались следующие:
1. Логистическая регрессия
2. Машина наименьших квадратов
3. Модель k-ближайших соседей
4. Модель случайного леса

В качестве критериев сравнения моделей использовались:
1. **Точность** - доля правильно классифицированных вин в общем количестве вин из тестовой выборки.
2. **Отчет по классификации**: включает 3 показателя с разбивкой по 3 региона:
   - **Точность** (доля правильно предсказанных вин в общем числе предсказанных вин из этого региона)
   - **Полнота** (доля вин, определенных моделью для этого региона, в общем числе вин из этого региона)
   - **F1-score** - среднее гармоническое 2-х предыдущих показателей, удобно для сводного анализа при несбалансированной выборке, когда доля регионов сильно отличается. Для общего анализа применяется также усреднение по классам (регионам):
     - **Macroaverage** - простое арифметическое среднее предыдущих 3-х показателей
     - **Weighted average** - среднее взвешенное по долям регионов в общей выборке.
3. **Матрица ошибок** - наиболее интуитивно понятный инструмент. Удобен для небольшого числа категорий. В нашем случае это матрица 3 на 3, где по вертикальной оси отмечаются реальные регионы происхождения, а по горизонтальной - предсказанные. В данном отчете мы будем использовать именно ее как наиболее показательную и понятную. С остальными метриками можно ознакомиться в выводе самой программы.

При подготовке данных к построению моделей была проведена проверка на наличие пропусков, сами данные были отнормированы к Гауссовскому распределению.

## Матрицы ошибок

Матрица ошибок для логистической регрессии выглядит следующим образом:


12 |0 |0
0 |14 |0
0 |1 |9



Как мы видим, модель хорошо работает для 1 и 2-го региона и чуть хуже для 3-го.

Результаты для машины наименьших квадратов представлены ниже:

12 |0 |0
0 |14 |0
0 |1 |9


В целом, они полностью совпадают с прогнозом логистической модели.

А вот метод k-ближайших соседей чуть лучше работает со третьим регионом, но при этом чуть менее точно определяет вина из 2-го региона. Матрица его ошибок представлена ниже:

12 |0 |0
0 |13 |1
0 |0 |10

И наконец, модель случайного леса правильно предсказала происхождение вин из всех трех регионов:

12 |0 |0
0 |14 |0
0 |0 |10

Первоначально,ее и было решено использовать для предсказания региона происхождения. Однако, при проверке результатов на устойчивость к изменению параметров случайного отбора для разделения на обучающую и тестовую выборку, результаты логистической модели оказались лучше. Из 10 проведенных сессий логистическая регрессия показала 100% попадания в 7 случаях, в то время как случайный лес показал лишь 3 случая из 10.
Таким образом было принято решение использовать логистическую модель. Для конечного определения ее параметров, использовалась функция поиска по сетке GridSearchCV.   Параметры лучшей модели получились следующие:
*C': 0.1, 'max_iter': 100, 'penalty': 'l2', 'solver': 'lbfgs'*

Таким образом можно сделать вывод, что для предсказания региона происхождения вина лучше всего подходит логистическая регрессионная модель, однако и модель случайного леса не сильно уступает  по своим результатам. Для окончательного вывода требуется более обширная выборка и дополнительные исследования.
